---
title: "Data wrangling functions"
author: "Indrajeet Patil"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteEngine{knitr::knitr}
  %\VignetteIndexEntry{Data wrangling functions}
  \usepackage[utf8]{inputenc}
---
  
```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
## Data wrangling functions

This vignette will provide documentation for how to use data wrangling helper functions from the package `ipmisc`.

## transpose_df

Although both `data.table::transpose` and `base::t` functions can transpose a dataframe, they both have their shortcomings. This can be illustrated one of the most common instances where the dataframe needs to be transposed: displaying results from statistical tests in a table.

```{r transpose_df}
library(datasets)
library(stats)
library(data.table)
library(ipmisc)

# define a new dataframe containing coefficients from linear regression
df <-
  cbind.data.frame("coef" = coef(stats::lm(
    data = mtcars,
    formula = mpg ~ am*cyl
  )))

# print the dataframe
print(df)

# let's say we need the coefficients which are in rows right now to be in columns for publication
# we will need to transpose this dataframe while preserving names of rows and columns

# transform using data.table::transpose function
data.table::transpose(l = df)

# this doesn't preserve rows and names and additional renaming steps will be required

# transform using base::t() function
base::t(x = df)

# although this seems to do the trick, it has converted a dataframe into a matrix, which is undesirable behavior
str(base::t(x = df))

# doing this with ipmisc::transpose_df() function
ipmisc::transpose_df(df = df, var = "effect")

# this returns a tibble dataframe with row and column names preserved

```

## strip_attributes

Attributes are used to store metadata about a dataframe. As Hadley Wickham notes in *Advanced R* (2014), there are three atttributes that are most important: Names, Dimensions, Class. In some cases, you might want to remove non-important attributes from a dataframe. `ipmisc::strip_attributes` achieves this.

## grouped_proptest

This function lets you carry out proportion test for every combination of levels of whatever grouping variables you are working with.
```{r grouped_proptest}
library(datasets)

# let's say we want to figure out if the proportion of automatic (am = 0) to manual (am = 1) 
# transmission cars is equal for each type of cylinder count (cyl) in the mtcars dataset
ipmisc::grouped_proptest(data = mtcars,
grouping.vars = cyl,
measure = am)

```
